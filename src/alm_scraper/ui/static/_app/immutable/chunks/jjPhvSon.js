import{a as b,f as x}from"./CvdHxPe0.js";import{p as B,o as X,i as q,g as o,f as J,a as Q,b as r,s as n,d as _,n as A,c as w,r as E,t as L}from"./B1j5rJTE.js";import{d as V,s as W}from"./Dx-hkKOW.js";import{i as T}from"./DVB0i_tY.js";import{r as Y,c as Z}from"./CrcgNFAs.js";import{b as M}from"./CFke6ymc.js";import{g}from"./CJU9tnj-.js";var $=x('<div class="fixed bottom-16 left-4 bg-muted border rounded px-3 py-1.5 text-sm font-mono shadow-lg z-50"> </div>'),ee=x('<div class="fixed bottom-16 left-4 bg-background border rounded px-3 py-2 shadow-lg z-50 flex items-center gap-2"><label for="goto-defect-input" class="text-sm text-muted-foreground">Go to defect:</label> <input id="goto-defect-input" type="text" inputmode="numeric" pattern="[0-9]*" class="w-24 bg-transparent border-b border-primary font-mono text-primary focus:outline-none"/> <span class="text-xs text-muted-foreground ml-2">Enter to go, Esc to cancel</span></div>'),te=x('<div class="fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center" role="button" tabindex="-1"><div class="bg-card border rounded-lg shadow-xl p-6 max-w-md" role="presentation"><h2 class="text-lg font-semibold mb-4">Keyboard Shortcuts</h2> <div class="space-y-3 text-sm"><div class="grid grid-cols-[80px_1fr] gap-2"><h3 class="font-medium text-muted-foreground col-span-2 mt-2">Navigation</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">j</kbd> <span>Move down</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">k</kbd> <span>Move up</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">Enter</kbd> <span>Open selected defect</span> <h3 class="font-medium text-muted-foreground col-span-2 mt-4">Go to</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g d</kbd> <span>Go to defect by ID</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g h</kbd> <span>Go home (defect list)</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g s</kbd> <span>Go to stats/dashboard</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g b</kbd> <span>Go to kanban board</span> <h3 class="font-medium text-muted-foreground col-span-2 mt-4">Other</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">/</kbd> <span>Focus search</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">?</kbd> <span>Show this help</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">Esc</kbd> <span>Clear / close</span></div></div> <div class="mt-6 text-xs text-muted-foreground text-center">Press <kbd class="font-mono bg-muted px-1 py-0.5 rounded">Esc</kbd> or click outside to close</div></div></div>'),oe=x('<!> <!> <!> <div class="fixed bottom-4 left-4 text-xs text-muted-foreground bg-background/90 backdrop-blur-sm px-2 py-1 rounded border">Press <kbd class="font-mono bg-muted px-1 py-0.5 rounded">?</kbd> for keyboard shortcuts</div>',1);function ie(P,c){B(c,!0);let v=r(""),l=null,i=r(!1),d=r(""),k=r(null),p=r(null),u=r(!1),f=r(""),y=null;function m(e,t=2e3){n(f,e,!0),y&&clearTimeout(y),y=setTimeout(()=>{n(f,"")},t)}function h(){n(v,""),l&&(clearTimeout(l),l=null)}function S(e){n(v,e,!0),m(`${e} ...`,1500),l=setTimeout(h,1500)}async function j(e){const t=parseInt(e,10);if(isNaN(t)||t<=0){m(`Invalid defect ID: ${e}`);return}try{(await fetch(`/api/defects/${t}`)).ok?g(`/defects/${t}`):m(`Defect #${t} not found`)}catch{m(`Error checking defect #${t}`)}}function D(){n(i,!1),n(d,"")}function z(e){e.key==="Enter"?(o(d)&&j(o(d)),D(),e.preventDefault()):e.key==="Escape"?(D(),e.preventDefault()):!/^\d$/.test(e.key)&&!["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Home","End"].includes(e.key)&&!e.ctrlKey&&!e.metaKey&&e.preventDefault()}function O(e){const t=e.target;n(d,t.value.replace(/\D/g,""),!0)}function G(e){o(p)&&!o(p).contains(e.target)&&D()}function I(e){const t=e.target,s=t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable;if(!o(i)){if(o(u)){if(e.key==="Escape"||e.key==="?"){n(u,!1),e.preventDefault();return}return}if(s){e.key==="Escape"&&(t.blur(),e.preventDefault());return}if(o(v)==="g"){if(h(),n(f,""),e.key==="d"){n(i,!0),n(d,""),e.preventDefault();return}if(e.key==="h"){g("/"),e.preventDefault();return}if(e.key==="s"){g("/stats"),e.preventDefault();return}if(e.key==="b"){g("/kanban"),e.preventDefault();return}return}switch(e.key){case"g":S("g"),e.preventDefault();break;case"/":c.searchInput?.focus(),e.preventDefault();break;case"?":n(u,!0),e.preventDefault();break;case"j":c.onNavigateDown?.(),e.preventDefault();break;case"k":c.onNavigateUp?.(),e.preventDefault();break;case"Enter":c.onSelect?.(),e.preventDefault();break;case"Escape":h();break}}}X(()=>(window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I))),q(()=>{if(o(i))return setTimeout(()=>o(k)?.focus(),0),document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}});var N=oe(),C=J(N);{var F=e=>{var t=$(),s=w(t,!0);E(t),L(()=>W(s,o(f))),b(e,t)};T(C,e=>{o(f)&&e(F)})}var K=_(C,2);{var H=e=>{var t=ee(),s=_(w(t),2);Y(s),s.__keydown=z,s.__input=O,M(s,a=>n(k,a),()=>o(k)),A(2),E(t),M(t,a=>n(p,a),()=>o(p)),L(()=>Z(s,o(d))),b(e,t)};T(K,e=>{o(i)&&e(H)})}var R=_(K,2);{var U=e=>{var t=te();t.__click=()=>n(u,!1),t.__keydown=a=>a.key==="Escape"&&n(u,!1);var s=w(t);s.__click=a=>a.stopPropagation(),E(t),b(e,t)};T(R,e=>{o(u)&&e(U)})}A(2),b(P,N),Q()}V(["keydown","input","click"]);export{ie as K};
