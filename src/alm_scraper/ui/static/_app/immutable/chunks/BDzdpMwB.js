import{a as m,f as v}from"./CeFSxQbd.js";import{p as F,o as L,f as O,a as U,g as a,d as D,n as _,s,b as l,c as b,r as x,t as N}from"./BRtkYQ1n.js";import{d as B,s as C}from"./E6HBHZWA.js";import{i as w}from"./B9s1PaqY.js";import{g as k}from"./D6cHjFh5.js";var H=v('<div class="fixed bottom-16 left-4 bg-muted border rounded px-3 py-1.5 text-sm font-mono shadow-lg z-50"> </div>'),R=v('<div class="fixed bottom-16 left-4 bg-background border rounded px-3 py-2 shadow-lg z-50 flex items-center gap-2"><span class="text-sm text-muted-foreground">Go to defect:</span> <span class="font-mono text-primary"> <span class="animate-pulse">_</span></span> <span class="text-xs text-muted-foreground ml-2">Enter to go, Esc to cancel</span></div>'),X=v('<div class="fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center" role="button" tabindex="-1"><div class="bg-card border rounded-lg shadow-xl p-6 max-w-md"><h2 class="text-lg font-semibold mb-4">Keyboard Shortcuts</h2> <div class="space-y-3 text-sm"><div class="grid grid-cols-[80px_1fr] gap-2"><h3 class="font-medium text-muted-foreground col-span-2 mt-2">Navigation</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">j</kbd> <span>Move down</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">k</kbd> <span>Move up</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">Enter</kbd> <span>Open selected defect</span> <h3 class="font-medium text-muted-foreground col-span-2 mt-4">Go to</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g d</kbd> <span>Go to defect by ID</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g h</kbd> <span>Go home (defect list)</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g s</kbd> <span>Go to stats/dashboard</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">g b</kbd> <span>Go to kanban board</span> <h3 class="font-medium text-muted-foreground col-span-2 mt-4">Other</h3> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">/</kbd> <span>Focus search</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">?</kbd> <span>Show this help</span> <kbd class="font-mono bg-muted px-1.5 py-0.5 rounded text-xs">Esc</kbd> <span>Clear / close</span></div></div> <div class="mt-6 text-xs text-muted-foreground text-center">Press <kbd class="font-mono bg-muted px-1 py-0.5 rounded">Esc</kbd> or click outside to close</div></div></div>'),q=v('<!> <!> <!> <div class="fixed bottom-4 left-4 text-xs text-muted-foreground bg-background/90 backdrop-blur-sm px-2 py-1 rounded border">Press <kbd class="font-mono bg-muted px-1 py-0.5 rounded">?</kbd> for keyboard shortcuts</div>',1);function Z(K,d){F(d,!0);let g=l(""),i=null,u=l(!1),o=l(""),r=l(!1),c=l(""),y=null;function p(e,t=2e3){s(c,e,!0),y&&clearTimeout(y),y=setTimeout(()=>{s(c,"")},t)}function h(){s(g,""),i&&(clearTimeout(i),i=null)}function M(e){s(g,e,!0),p(`${e} ...`,1500),i=setTimeout(h,1500)}async function P(e){const t=parseInt(e,10);if(isNaN(t)||t<=0){p(`Invalid defect ID: ${e}`);return}try{(await fetch(`/api/defects/${t}`)).ok?k(`/defects/${t}`):p(`Defect #${t} not found`)}catch{p(`Error checking defect #${t}`)}}function E(e){const t=e.target,n=t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable;if(a(u)){if(e.key==="Escape"){s(u,!1),s(o,""),e.preventDefault();return}if(e.key==="Enter"){a(o)&&P(a(o)),s(u,!1),s(o,""),e.preventDefault();return}if(e.key==="Backspace"){s(o,a(o).slice(0,-1),!0),e.preventDefault();return}if(/^\d$/.test(e.key)){s(o,a(o)+e.key),e.preventDefault();return}return}if(a(r)){if(e.key==="Escape"||e.key==="?"){s(r,!1),e.preventDefault();return}return}if(n){e.key==="Escape"&&(t.blur(),e.preventDefault());return}if(a(g)==="g"){if(h(),s(c,""),e.key==="d"){s(u,!0),s(o,""),e.preventDefault();return}if(e.key==="h"){k("/"),e.preventDefault();return}if(e.key==="s"){k("/stats"),e.preventDefault();return}if(e.key==="b"){k("/kanban"),e.preventDefault();return}return}switch(e.key){case"g":M("g"),e.preventDefault();break;case"/":d.searchInput?.focus(),e.preventDefault();break;case"?":s(r,!0),e.preventDefault();break;case"j":d.onNavigateDown?.(),e.preventDefault();break;case"k":d.onNavigateUp?.(),e.preventDefault();break;case"Enter":d.onSelect?.(),e.preventDefault();break;case"Escape":h();break}}L(()=>(window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)));var T=q(),I=O(T);{var S=e=>{var t=H(),n=b(t,!0);x(t),N(()=>C(n,a(c))),m(e,t)};w(I,e=>{a(c)&&e(S)})}var G=D(I,2);{var j=e=>{var t=R(),n=D(b(t),2),f=b(n,!0);_(),x(n),_(2),x(t),N(()=>C(f,a(o)||"")),m(e,t)};w(G,e=>{a(u)&&e(j)})}var z=D(G,2);{var A=e=>{var t=X();t.__click=()=>s(r,!1),t.__keydown=f=>f.key==="Escape"&&s(r,!1);var n=b(t);n.__click=f=>f.stopPropagation(),x(t),m(e,t)};w(z,e=>{a(r)&&e(A)})}_(2),m(K,T),U()}B(["click","keydown"]);export{Z as K};
